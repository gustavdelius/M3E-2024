# Age-structured population model

## Continuous time model

In the previous chapter we structured the population by a discrete variable, the sex of the individuals. This gave rise to a system of coupled ODEs, one ODE for each class of individuals. In this section we will structure the population by a continuous variable, the age of the individuals. This will give rise to a partial differential equation (PDE) for the age-dependent population density. We will solve this PDE and study the long-term behaviour of the population and its age distribution.

So instead of describing the population just by the total number of individuals $N(t)$, we will describe it by the density $n(t,a)$ of individuals at age $a$. The total number $N(t)$ of individuals in the population  is then given by the integral of $n(at,a)$ over all ages. More generally, the total number of individuals in the population that are between age $a_1$ and $a_2$ is given by the integral of $n(t,a)$ over the interval $[a_1,a_2]$. You are familiar with the concept of density from probability theory, where continuous random variables are described by a probability density rather than a probability. You may also be familiar with the concept from physics, where the density of a material describes how the mass is distributed over space. Here, the density $n(t,a)$ describes how the individuals are distributed over ages.

To derive the PDE for the age-structured population density, we consider how the density changes over an infinitesimal time interval $\delta t$ due to deaths:
$$
n(t+\delta t, a+\delta t) = n(t,a) - \mu(a) n(t,a) \delta t.
$$ {#eq-a1}
Note how we had to take into account that over the time interval $\delta t$ the age of the individuals has increased by $\delta t$. We now Taylor-expand the left-hand side around $t$ and $a$:
$$
n(t+\delta t, a+\delta t) = n(t,a) + \frac{\partial n}{\partial t} \delta t + \frac{\partial n}{\partial a} \delta t + \mathcal{O}(\delta t^2).
$$ {#eq-a2}
Cancelling the $n(t,a)$ terms on both sides and dividing by $\delta t$ gives us the PDE for the age-structured population density:
$$
\frac{\partial n}{\partial t} + \frac{\partial n}{\partial a} = -\mu(a) n.
$$ {#eq-a3}

This equation captures the effect of individuals aging and dying, but it does not capture how they are born. Individuals are born with age $0$. These offspring can be produced by parents of any ages, but with an age-dependent rate $b(a)$. This gives
$$
n(t,0) = \int_0^\infty b(a) n(t,a) \, da.
$$ {#eq-a4}
This is a boundary condition for the PDE. It says that the density of individuals at age $0$ is given by the total number of offspring produced by the individuals of all ages. 

We will now solve the PDE for the age-structured population density by the method of separation of variables. We will make the Ansatz $n(t,a) = f(t) r(a)$. You have seen this trick for finding solutions of linear, homogeneous PDEs in other modules, like Waves and Fluids for example. Substituting this Ansatz into the PDE gives
$$
f'(t) r(a) + f(t) r'(a) = -\mu(a) f(t) r(a).
$$ {#eq-a5}
Dividing by $f(t) r(a)$ gives
$$
\frac{f'(t)}{f(t)} + \frac{r'(a)}{r(a)} = -\mu(a).
$$ {#eq-a6}
We now collect all terms that depend on $t$ on the left-hand side and all terms that depend on $a$ on the right-hand side:
$$
\frac{f'(t)}{f(t)} = - \frac{r'(a)}{r(a)} - \mu(a).
$$ {#eq-a7}
Because the left-hand side is independent of $a$ and the right-hand side is independent of $t$, both sides must be equal to a constant. We introduce the separation constant $\gamma$ and write
$$
\frac{f'(t)}{f(t)} = \gamma, \quad \frac{r'(a)}{r(a)} = -\gamma - \mu(a).
$$ {#eq-a8}
These are now linear ODEs and hence easy to solve. The first ODE has the solution 
$$
f(t) = f(0) e^{\gamma t}
$$ {#eq-a9}
and the second ODE has the solution
$$
r(a) = r(0) \exp\left(-\int_0^a \mu(a') \, da'-\gamma a\right).
$$  {#eq-a10}

So altogether we have the population density
$$
n(t,a) = n(0,0) e^{\gamma t} \exp\left(-\int_0^a \mu(a') \, da'-\gamma a\right),
$$ {#eq-a11}
where $n(0,0)=f(0)r(0)$ is the initial density of individuals at age $0$. 

So far we don't yet know the value of the separation constant $\gamma$. This will be determined by the boundary condition. If we substitute the solution @eq-a11 into the boundary condition @eq-a4, we get
$$
n(0,0)e^{\gamma t} = \int_0^\infty b(a) n(0,0)e^{\gamma t} \exp\left(-\int_0^a \mu(a') \, da'-\gamma a\right)\, da.
$$ {#eq-a12}
We can cancel the common factor $n(0,0)e^{\gamma t}$ on both sides to get the condition
$$
1= \int_0^\infty b(a) \exp\left(-\int_0^a \mu(a') \, da'-\gamma a\right) \, da = \phi(\gamma).
$$ {#eq-a13}
We have introduced the shorthand notation $\phi(\gamma)$ for the integral on the right-hand side. The condition @eq-a12 is a transcendental equation for $\gamma$. We cannot solve it analytically for $\gamma$. But we observe that $\phi$ is a monotonically decreasing function of $\gamma$. This observation alone allows us to make a statement about the sign of $\gamma$. According to @eq-a9 the sign of $\gamma$ determines whether the total population grows expnentially or goes extinct.

If $\gamma$ is positive, then the monotonicity of $\phi$ tells us that $\phi(0) > \phi(\gamma)  = 1$ and vice versa. Conversely, if $\gamma$ is negative, then $\phi(0) < \phi(\gamma) = 1$ and vice versa. So to determine the sign of $\gamma$ we only have to look at the value of
$$
\phi(0) = \int_0^\infty b(a) \exp\left(-\int_0^a \mu(a') \, da'\right)\, da.
$$ {#eq-a14}

* If $\phi(0) > 1$, then  $\gamma > 0$ and the population grows exponentially.

* If $\phi(0) < 1$, then $\gamma < 0$ and the population goes extinct.

This result actually has a very intuitive explanation. The factor
$$
\exp\left(-\int_0^a \mu(a') \, da'\right)=:l(a)
$$ {#eq-a15}
is the probability that an individual survives up to age $a$. Therefore $\phi(0)$ is the expected number of offspring produced by an individual during its lifetime. If this number is greater than $1$, then the population grows exponentially. If it is less than $1$, then the population goes extinct.


## Discrete time model

To come in week 5.

## Exercises

#### * Age-independent rates
::: {#exr-age_structured}
In the continuous-time age-structured population model consider the case where $b(a)=b$
and $\mu(a)=\mu$ are both constant. Repeat all steps of the analysis but simplifying the expressions at each step by using the constant values for birth and death rates.

1. Solve the partial differential
equation of the age-structured model by making the Ansatz $n(t,a)=f(t)r(a)$ and introducing the separation constant $\gamma$.
2. Use the boundary condition at $a=0$ to determine the value of $\gamma$.
3. Give the condition under which the population goes extinct and compare it to the condition in the exponential model from chapter 1.
:::

#### o Harvestings an age-structured population
::: {#exr-age_harvesting}
Consider an age-structured fish population in which all individuals above the maturity age $a_m$ are reproducing, at a fixed rate, so that
$$
b(a) = \begin{cases}
0 & \text{if } a < a_m, \\
b & \text{if } a \geq a_m.
\end{cases}
$$ {#eq-age_harvesting_1}
All fish at all ages experience a natural death rate $\mu_0$. In addition, fish above the maturity size are harvested at a constant rate $\mu_F$, so that
$$
\mu(a) = \begin{cases}
\mu_0 & \text{if } a < a_m, \\
\mu_0 + \mu_F & \text{if } a \geq a_m.
\end{cases}
$$ {#eq-age_harvesting_2}
By calculating the expected number of offspring per individual, determine the limit on the harvesting rate $\mu_F$ that allows the population to be sustainable.
:::
